version: "3.9"
services:
    nginx:
        build:
            context: ./docker/nginx/
            dockerfile: ./Dockerfile
        ports:
            - 80:8080
        depends_on:
            - php
        volumes:
            - ./contents:/usr/share/nginx/html
    php:
        image: php:8-fpm
        build:
            context: ./docker/php/
            dockerfile: ./Dockerfile
        volumes:
            - ./    :/usr/share/nginx/html
    db:
        build:
            context: ./docker/db/
            dockerfile: ./Dockerfile
        ports:
            - 3306:3306
        environment:
            MYSQL_DATABASE: database
            MYSQL_USER: user
            MYSQL_PASSWORD: password
            MYSQL_ROOT_PASSWORD: password
            TZ: 'Asia/Tokyo'
        volumes:
            - mysql-volume:/var/lib/mysql       
volumes:
    mysql-volume: